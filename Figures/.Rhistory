Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * (T3 - T4)/Denominator#
            Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (T2 - T3)/Denominator#
            Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (0)/Denominator#
        }#
        if ((CurTree == 5) || (CurTree == 8) || (CurTree == 11) || (CurTree == 14)){#
            T2 <- T2MeanTimes[Paths]#
            T3 <- T3MeanTimes[Paths]#
            T4 <- ConvertT4MeanTimes[Paths]#
            Denominator <- 2*T4 + T3 + T2 + (T2 - T3) + (T3 - T4)#
            Probabilities[1] <- Probabilities[1] + TreeSum[Paths,CurTree] * (T4 + T3)/Denominator#
            Probabilities[2] <- Probabilities[2] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[3] <- Probabilities[3] + TreeSum[Paths,CurTree] * (T4 + T2)/Denominator#
            Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * (T3 - T4)/Denominator#
            Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (T2 - T3)/Denominator#
        }#
        if ((CurTree == 6) || (CurTree == 9) || (CurTree == 12) || (CurTree == 15)){#
            T2 <- T2MeanTimes[Paths]#
            T3 <- T3MeanTimes[Paths]#
            T4 <- ConvertT4MeanTimes[Paths]#
            Denominator <- 2*T4 + 2* T3 + (T2 - T3) + (T2 - T4)#
            Probabilities[1] <- Probabilities[1] + TreeSum[Paths,CurTree] * (T4 + T3)/Denominator#
            Probabilities[2] <- Probabilities[2] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[3] <- Probabilities[3] + TreeSum[Paths,CurTree] * (T4 + T3)/Denominator#
            Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * ((T2 - T3) + (T2 - T4))/Denominator#
            Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (0)/Denominator#
        }#
        if ((CurTree == 16) || (CurTree == 17)){#
            T2 <- T2MeanTimes[Paths]#
            T3 <- T3MeanTimes[Paths]#
            T4 <- ConvertT4MeanTimes[Paths]#
            Denominator <- 2*T4 + T3 + T2 + (T2 - T3) + (T3 - T4)#
            Probabilities[1] <- Probabilities[1] + TreeSum[Paths,CurTree] * (2 * T4)/Denominator#
            Probabilities[2] <- Probabilities[2] + TreeSum[Paths,CurTree] * (T3 - T4)/Denominator#
            Probabilities[3] <- Probabilities[3] + TreeSum[Paths,CurTree] * (T3 + T2)/Denominator#
            Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (T2 - T3)/Denominator#
        }#
        if ((CurTree == 18)){#
            T2 <- T2MeanTimes[Paths]#
            T3 <- T3MeanTimes[Paths]#
            T4 <- ConvertT4MeanTimes[Paths]#
            Denominator <- 2*T4 + 2* T3 + (T2 - T3) + (T2 - T4)#
            Probabilities[1] <- Probabilities[1] + TreeSum[Paths,CurTree] * (2*T4)/Denominator#
            Probabilities[2] <- Probabilities[2] + TreeSum[Paths,CurTree] * (T2 - T4)/Denominator#
            Probabilities[3] <- Probabilities[3] + TreeSum[Paths,CurTree] * (2*T3)/Denominator#
            Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (0)/Denominator#
            Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (T2 - T3)/Denominator#
            Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (0)/Denominator#
        }#
    }#
}#
ProbList <- rbind(ProbList,Probabilities)#
Value <- ProportionTestValue$V1*log(Probabilities[1]) + ProportionTestValue$V2*log(Probabilities[2]) + ProportionTestValue$V3*log(Probabilities[3]) + ProportionTestValue$V4*log(Probabilities[4]) + ProportionTestValue$V5*log(Probabilities[5]) + ProportionTestValue$V6*log(Probabilities[6]) + ProportionTestValue$V7*log(Probabilities[7])#
LL <- c(LL, Value)#
}#
#
pdf("LLMigRate.pdf")#
par(mar=c(4.1,5.1,4.1,2.1))#
plot(LL,type="o",xaxt='n',xlab="4Nm",cex=2,pch=19,cex.axis=2,cex.lab=2)#
arrows(3,LL[3]-10000,3,LL[3]-1000)#
axis(1,at=c(1,2,3,4,5,6,7,8),labels=c("0.5","1.5","5","10","15","50","100","150"),cex.axis=1.5)#
legend(1.2,LL[3]-8000,"True value",bty="n",cex=2)#
dev.off()#
#
############################# Population size change #################################
MigrationRate <- c(0.01,0.05,0.1,0.5,1,5,10,50)#
ProbList <- Matrix(,ncol=7,nrow=0)#
#
ProportionTestValue <- read.table("ProportionsSizeChange.txt")#
LL <- c()#
for (Mig in 1:8){#
    ### Construct Matrices#
    VeryRecentMatrix <- matrix(0,nrow=5,ncol=5)#
    Matrix <- matrix(0,nrow=14,ncol=14)#
    MiniMatrixTest <- matrix(0,nrow=4,ncol=4)#
    m1 <- 0#
    m2 <- 666.666667#
    AncM1 <- 0#
    AncM2 <- 0#
    Theta1 <- 0.005#
    Theta2 <- 0.005  * MigrationRate[Mig]#
    ThetaA <- 0.002#
    DivTime <- 0.3#
    AncTime <- 0.05#
    #################### Set mu ############################
    mu <- 1e-8#
    N_1 <- Theta1 / (4*mu)#
    N_2 <- Theta2 / (4*mu)#
    N_A <- ThetaA / (4*mu)#
    mig1 <- m1 * (mu)#
    mig2 <- m2 * (mu)#
    ancmig1 <- AncM1 * mu#
    ancmig2 <- AncM2 * mu#
    TwoN1mig1 <- 2*N_1* mig1#
    TwoN2mig2 <- 5#
    TwoN1Ancmig1 <- 2*N_1* ancmig1#
    TwoN2Ancmig2 <- 2*N_1* ancmig2#
    DivergenceTime <- DivTime/mu#
    AncestralSampleTime <- AncTime/mu#
    #DivergenceTimeInGens <- N_1*4*0.6#
    DivergenceTimeInGens <- N_1*4*10#
    #AncestralTimeInGens <- N_1*4*0.1#
    AncestralTimeInGens <- N_1*4*0.0#
    BinLimitDivTime <- DivergenceTimeInGens/2000#
    BinLimitAncTime <- AncestralTimeInGens/2000#
    DivTimeMs <- DivergenceTime / (4*N_1)#
    AncTimeMs <- AncestralSampleTime / (4*N_1)#
    ########################################################
    VeryRecentMatrix[1,1] <- - 2*TwoN1Ancmig1 - 1#
    VeryRecentMatrix[1,2] <- 2*TwoN1Ancmig1#
    VeryRecentMatrix[1,4] <- 1#
    VeryRecentMatrix[2,1] <- TwoN2Ancmig2#
    VeryRecentMatrix[2,2] <- - TwoN2Ancmig2 - TwoN1Ancmig1#
    VeryRecentMatrix[2,3] <- TwoN1Ancmig1#
    VeryRecentMatrix[3,2] <- 2*TwoN2Ancmig2#
    VeryRecentMatrix[3,3] <- - 2*TwoN2Ancmig2 - 1 * N_1 / N_2#
    VeryRecentMatrix[3,5] <- 1 * N_1 / N_2#
    VeryRecentMatrix[4,4] <- -TwoN1Ancmig1#
    VeryRecentMatrix[4,5] <- TwoN1Ancmig1#
    VeryRecentMatrix[5,4] <- TwoN2Ancmig2#
    VeryRecentMatrix[5,5] <- -TwoN2Ancmig2#
    ########################################################
    Matrix[1,1] <- -4*TwoN1mig1 - 6#
    Matrix[1,2] <- 4*TwoN1mig1#
    Matrix[1,6] <- 6#
    Matrix[2,1] <- TwoN2mig2#
    Matrix[2,2] <- -TwoN2mig2 -3*TwoN1mig1 - 3#
    Matrix[2,3] <- 3 * TwoN1mig1#
    Matrix[2,7] <- 3#
    Matrix[3,2] <- 2*TwoN2mig2#
    Matrix[3,3] <- -2*TwoN2mig2 - 2*TwoN1mig1 - 1 * N_1 / N_2 - 1#
    Matrix[3,4] <- 2*TwoN1mig1#
    Matrix[3,7] <- 1 * N_1 / N_2#
    Matrix[3,8] <- 1#
    Matrix[4,3] <- 3*TwoN2mig2#
    Matrix[4,4] <- -3*TwoN2mig2 - TwoN1mig1 - 3* N_1 / N_2#
    Matrix[4,5] <- TwoN1mig1#
    Matrix[4,8] <- 3* N_1 / N_2#
    Matrix[5,4] <- 4*TwoN2mig2#
    Matrix[5,5] <- -4*TwoN2mig2 - 6 * N_1 / N_2#
    Matrix[5,9] <- 6 * N_1 / N_2#
    Matrix[6,6] <- - 3*TwoN1mig1 - 3#
    Matrix[6,7] <- 3*TwoN1mig1#
    Matrix[6,10] <- 3#
    Matrix[7,6] <- TwoN2mig2#
    Matrix[7,7] <- -TwoN2mig2 - 2*TwoN1mig1 - 1#
    Matrix[7,8] <- 2*TwoN1mig1#
    Matrix[7,11] <- 1#
    Matrix[8,7] <- 2*TwoN2mig2#
    Matrix[8,8] <- -2*TwoN2mig2 - TwoN1mig1 - 1 * N_1 / N_2#
    Matrix[8,9] <- TwoN1mig1#
    Matrix[8,11] <- 1 * N_1 / N_2#
    Matrix[9,8] <- 3*TwoN2mig2#
    Matrix[9,9] <- -3*TwoN2mig2 - 3 * N_1 / N_2#
    Matrix[9,12] <- 3 * N_1 / N_2#
    Matrix[10,10] <- - 2*TwoN1mig1 - 1#
    Matrix[10,11] <- 2*TwoN1mig1#
    Matrix[10,13] <- 1#
    Matrix[11,10] <- TwoN2mig2#
    Matrix[11,11] <- - TwoN2mig2 - TwoN1mig1#
    Matrix[11,12] <- TwoN1mig1#
    Matrix[12,11] <- 2*TwoN2mig2#
    Matrix[12,12] <- - 2*TwoN2mig2 - 1 * N_1 / N_2#
    Matrix[12,14] <- 1 * N_1 / N_2#
    Matrix[13,13] <- -TwoN1mig1#
    Matrix[13,14] <- TwoN1mig1#
    Matrix[14,13] <- TwoN2mig2#
    Matrix[14,14] <- -TwoN2mig2#
    ########################################################
    MiniMatrixTest[1,1] <- -6/0.4#
    MiniMatrixTest[1,2] <- 6/0.4#
    MiniMatrixTest[2,2] <- -3/0.4#
    MiniMatrixTest[2,3] <- 3/0.4#
    MiniMatrixTest[3,3] <- -1/0.4#
    MiniMatrixTest[3,4] <- 1/0.4#
    #### Get PDFs#
    print ("PDFs")#
    # T3Distribution <- DistributionOfT3(VeryRecentMatrix,Matrix,MiniMatrixTest,1000000,0,1000000,500,10000)#
    # T4Distribution <- DistributionOfT4(VeryRecentMatrix,Matrix,MiniMatrixTest,1000000,0,1000000,500,10000)#
    # TreeTypeOne <- DistributionOfTreeTypes(VeryRecentMatrix,Matrix,MiniMatrixTest,1000000,0,1000000,500,10000)#
    T3Distribution <- DistributionOfT3(VeryRecentMatrix,Matrix,MiniMatrixTest,200000,0,200000,200,10000)#
    T4Distribution <- DistributionOfT4(VeryRecentMatrix,Matrix,MiniMatrixTest,200000,0,200000,200,10000)#
    TreeTypeOne <- DistributionOfTreeTypes(VeryRecentMatrix,Matrix,MiniMatrixTest,200000,0,200000,200,10000)#
    ##### Tree tests#
    print ("Tree tests")#
    SumPathFrequency <- c()#
    for (i in 1:11){#
        SumPathFrequency <- c(SumPathFrequency,sum(TreeTypeOne[,i]))#
    }#
    # Before June 28, 2017#
    # MatrixPathTreeFrequency <- read.table("MatrixPathTreeFrequency.txt")#
    MatrixPathTreeFrequency <- read.table("MatrixPathTreeFrequencyTreeOrder.txt")#
    TreeSum <- c()#
    TreeSum <- rbind(TreeSum,SumPathFrequency[1]*(MatrixPathTreeFrequency$V1))#
    TreeSum <- rbind(TreeSum,SumPathFrequency[2]*(MatrixPathTreeFrequency$V2))#
    TreeSum <- rbind(TreeSum,SumPathFrequency[3]*(MatrixPathTreeFrequency$V3))#
    TreeSum <- rbind(TreeSum,SumPathFrequency[4]*(MatrixPathTreeFrequency$V4))#
    TreeSum <- rbind(TreeSum,SumPathFrequency[5]*(MatrixPathTreeFrequency$V5))#
    TreeSum <- rbind(TreeSum,SumPathFrequency[6]*(MatrixPathTreeFrequency$V6))#
    TreeSum <- rbind(TreeSum,SumPathFrequency[7]*(MatrixPathTreeFrequency$V7))#
    TreeSum <- rbind(TreeSum,SumPathFrequency[8]*(MatrixPathTreeFrequency$V8))#
    TreeSum <- rbind(TreeSum,SumPathFrequency[9]*(MatrixPathTreeFrequency$V9))#
    TreeSum <- rbind(TreeSum,SumPathFrequency[10]*(MatrixPathTreeFrequency$V10))#
    TreeSum <- rbind(TreeSum,SumPathFrequency[11]*(MatrixPathTreeFrequency$V11))#
    FinalSum <- c()#
    for (i in 1:18){#
        FinalSum <- c(FinalSum,sum(TreeSum[,i]))#
    }#
    print ("Tree Mean T2")#
    T2MeanTimes <- c(0,0,0,0,0,0,0,0,0,0,0)#
    for (i in 1:11){#
        for (j in 1:nrow(TreeTypeOne)){#
            T2MeanTimes[i] <- T2MeanTimes[i] + TreeTypeOne[j,i]/sum(TreeTypeOne[,i])*j#
        }#
    }#
    print ("Tree Mean T3")#
    T3MeanTimes <- c(0,0,0,0,0,0,0,0,0,0,0)#
    for (i in 1:11){#
        for (j in 1:nrow(T3Distribution)){#
            T3MeanTimes[i] <- T3MeanTimes[i] + T3Distribution[j,i]/sum(T3Distribution[,i])*j#
        }#
    }#
    print ("Tree Mean T4")#
    T4MeanTimes <- c(0,0,0,0,0)#
    for (i in 1:5){#
        for (j in 3:nrow(T4Distribution)){#
            T4MeanTimes[i] <- T4MeanTimes[i] + T4Distribution[j,i]/sum(T4Distribution[,i])*(j-2)#
        }#
    }#
    ConvertT4MeanTimes <- c(T4MeanTimes[2],T4MeanTimes[5],T4MeanTimes[4],T4MeanTimes[4],T4MeanTimes[3],T4MeanTimes[3],T4MeanTimes[2],T4MeanTimes[2],T4MeanTimes[1],T4MeanTimes[1],T4MeanTimes[1])#
    print ("Probabilities")#
    Probabilities <- c(0,0,0,0,0,0,0)#
    TotalSum <- 0#
    for (Paths in 1:8){#
        for (CurTree in 1:18){#
            TotalSum <- TotalSum + TreeSum[Paths,CurTree]#
            #        print (Paths)#
            #        print (CurTree)#
            #        print(TreeSum[Paths,CurTree])#
            if ((CurTree == 1) || (CurTree == 2)){#
                T2 <- T2MeanTimes[Paths]#
                T3 <- T3MeanTimes[Paths]#
                T4 <- ConvertT4MeanTimes[Paths]#
                Denominator <- 2*T4 + T3 + T2 + (T2 - T3) + (T3 - T4)#
                Probabilities[1] <- Probabilities[1] + TreeSum[Paths,CurTree] * (T3 + T2)/Denominator#
                Probabilities[2] <- Probabilities[2] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[3] <- Probabilities[3] + TreeSum[Paths,CurTree] * (2*T4)/Denominator#
                Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (T2 - T3)/Denominator#
                Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (T3 - T4)/Denominator#
                Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (0)/Denominator#
            }#
            if ((CurTree == 3)){#
                T2 <- T2MeanTimes[Paths]#
                T3 <- T3MeanTimes[Paths]#
                T4 <- ConvertT4MeanTimes[Paths]#
                Denominator <- 2*T4 + 2* T3 + (T2 - T3) + (T2 - T4)#
                Probabilities[1] <- Probabilities[1] + TreeSum[Paths,CurTree] * (2*T3)/Denominator#
                Probabilities[2] <- Probabilities[2] + TreeSum[Paths,CurTree] * (T2 - T3)/Denominator#
                Probabilities[3] <- Probabilities[3] + TreeSum[Paths,CurTree] * (2*T4)/Denominator#
                Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (T2 - T4)/Denominator#
                Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (0)/Denominator#
            }#
            if ((CurTree == 4) || (CurTree == 7) || (CurTree == 10) || (CurTree == 13)){#
                T2 <- T2MeanTimes[Paths]#
                T3 <- T3MeanTimes[Paths]#
                T4 <- ConvertT4MeanTimes[Paths]#
                Denominator <- 2*T4 + T3 + T2 + (T2 - T3) + (T3 - T4)#
                Probabilities[1] <- Probabilities[1] + TreeSum[Paths,CurTree] * (T4 + T2)/Denominator#
                Probabilities[2] <- Probabilities[2] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[3] <- Probabilities[3] + TreeSum[Paths,CurTree] * (T4 + T3)/Denominator#
                Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * (T3 - T4)/Denominator#
                Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (T2 - T3)/Denominator#
                Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (0)/Denominator#
            }#
            if ((CurTree == 5) || (CurTree == 8) || (CurTree == 11) || (CurTree == 14)){#
                T2 <- T2MeanTimes[Paths]#
                T3 <- T3MeanTimes[Paths]#
                T4 <- ConvertT4MeanTimes[Paths]#
                Denominator <- 2*T4 + T3 + T2 + (T2 - T3) + (T3 - T4)#
                Probabilities[1] <- Probabilities[1] + TreeSum[Paths,CurTree] * (T4 + T3)/Denominator#
                Probabilities[2] <- Probabilities[2] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[3] <- Probabilities[3] + TreeSum[Paths,CurTree] * (T4 + T2)/Denominator#
                Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * (T3 - T4)/Denominator#
                Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (T2 - T3)/Denominator#
            }#
            if ((CurTree == 6) || (CurTree == 9) || (CurTree == 12) || (CurTree == 15)){#
                T2 <- T2MeanTimes[Paths]#
                T3 <- T3MeanTimes[Paths]#
                T4 <- ConvertT4MeanTimes[Paths]#
                Denominator <- 2*T4 + 2* T3 + (T2 - T3) + (T2 - T4)#
                Probabilities[1] <- Probabilities[1] + TreeSum[Paths,CurTree] * (T4 + T3)/Denominator#
                Probabilities[2] <- Probabilities[2] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[3] <- Probabilities[3] + TreeSum[Paths,CurTree] * (T4 + T3)/Denominator#
                Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * ((T2 - T3) + (T2 - T4))/Denominator#
                Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (0)/Denominator#
            }#
            if ((CurTree == 16) || (CurTree == 17)){#
                T2 <- T2MeanTimes[Paths]#
                T3 <- T3MeanTimes[Paths]#
                T4 <- ConvertT4MeanTimes[Paths]#
                Denominator <- 2*T4 + T3 + T2 + (T2 - T3) + (T3 - T4)#
                Probabilities[1] <- Probabilities[1] + TreeSum[Paths,CurTree] * (2 * T4)/Denominator#
                Probabilities[2] <- Probabilities[2] + TreeSum[Paths,CurTree] * (T3 - T4)/Denominator#
                Probabilities[3] <- Probabilities[3] + TreeSum[Paths,CurTree] * (T3 + T2)/Denominator#
                Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (T2 - T3)/Denominator#
            }#
            if ((CurTree == 18)){#
                T2 <- T2MeanTimes[Paths]#
                T3 <- T3MeanTimes[Paths]#
                T4 <- ConvertT4MeanTimes[Paths]#
                Denominator <- 2*T4 + 2* T3 + (T2 - T3) + (T2 - T4)#
                Probabilities[1] <- Probabilities[1] + TreeSum[Paths,CurTree] * (2*T4)/Denominator#
                Probabilities[2] <- Probabilities[2] + TreeSum[Paths,CurTree] * (T2 - T4)/Denominator#
                Probabilities[3] <- Probabilities[3] + TreeSum[Paths,CurTree] * (2*T3)/Denominator#
                Probabilities[4] <- Probabilities[4] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[7] <- Probabilities[7] + TreeSum[Paths,CurTree] * (0)/Denominator#
                Probabilities[6] <- Probabilities[6] + TreeSum[Paths,CurTree] * (T2 - T3)/Denominator#
                Probabilities[5] <- Probabilities[5] + TreeSum[Paths,CurTree] * (0)/Denominator#
            }#
        }#
    }#
    ProbList <- rbind(ProbList,Probabilities)#
    Value <- ProportionTestValue$V1*log(Probabilities[1]) + ProportionTestValue$V2*log(Probabilities[2]) + ProportionTestValue$V3*log(Probabilities[3]) + ProportionTestValue$V4*log(Probabilities[4]) + ProportionTestValue$V5*log(Probabilities[5]) + ProportionTestValue$V6*log(Probabilities[6]) + ProportionTestValue$V7*log(Probabilities[7])#
    LL <- c(LL, Value)#
}#
pdf("PopSizeChangeRate.pdf")#
par(mar=c(4.1,5.1,4.1,2.1))#
plot(LL,type="o",xaxt='n',xlab=expression(N[2]/N[1]),cex=2,pch=19,cex.axis=2,cex.lab=2)#
arrows(3,LL[3]-10000,3,LL[3]-1000)#
axis(1,at=c(1,2,3,4,5,6,7,8),labels=c("0.01","0.05","0.1","0.5","1","5","10","50"),cex.axis=1.5)#
legend(1.2,LL[3]-8000,"True value",bty="n",cex=2)#
dev.off()
611*2
factorial(72)
factorial(2)
factorial(72-2)
6.123446e+103/1.197857e+100
5112*611
factorial(72)/factorial(70)
6.123446e+103/(2*1.197857e+100)
250*48
1174/25
1264/25
3433000000/20
3433000000/17
255/60
#### run the main function by typing:#
# success_rate = test_venter(rounds, n)#
#
#n is the number of people in each group#
#rounds is the number of simulation rounds.#
#success_rate is the identifiability power of demographic iddentifiers#
#
# The function runs a simple procedure that matches the Venter et al.#
# definition of identifiability.#
# In each round, the function genreates sex, age, and self-reported ethnicity labels#
# for n people according to the distributions of the Venter paper. #
# It then takes the first person to be the person of interest#
# and compares whether this person is unique in the n people. #
# If the combination of labels for this person is unique, it says: "Success!"#
#
# Venter had a team of 30 researchers that developed fancy face morphology predictions, #
# voice signatures, and many other sophisticated algorithms. Using the same success creterion, #
# they had a success rate of 80%.#
#
# You are about to test a procedure that uses age, sex, and ethnic group which are not protected by #
#HIPAA and took me less than an hour to develop. #
# Try running test_venter(1000, 10)#
# and see the success rate.#
library(reshape)#
freq <- function(x){#
  return (x/sum(x))#
}#
#
inverse_cdf<-function(cdf) {#
  p = runif(1, 0, 1)#
#
  for (i in 1:length(cdf)) {#
    if (p < cdf[i]) {#
        return (i)#
    }#
  }#
  return (length(cdf))#
}#
simulate_a_group_of_people<-function(n, rounds) {#
  take_n_people = c()#
  #let's generate a group of n people from Venter's cohort#
  for (i in 1:n){#
    sex_ethnicity_label = inverse_cdf(people.cdf)#
    age_label =  inverse_cdf(age.cdf)#
    final_label = paste(sex_ethnicity_label, age_label, sep='_')#
    take_n_people = rbind(take_n_people, final_label)#
  }#
  colnames(take_n_people)[1] <- 'labels' #the name of the column#
  return(take_n_people)#
}#
test_venter<-function(rounds, n) {#
  #rounds: the number of times to run the procedure#
  #n: the group of individuals to re-identify the sample#
  #lading data#
  male = c(381,	126,	39,	39,	8,	39)#
  female = c(188, 147, 24, 24, 10, 36)#
  people = data.frame(male,female)#
  row.names(people) = c('African', 'European','Latino','East Asian','South Asian', 'Other')#
  age = c(295, 190, 130, 90, 95, 120, 100, 35, 5, 1)#
  #calculating pdfs#
  people.freq = freq(people)#
  age.freq = freq(age)#
  people.freq_v = melt(people.freq) #table to a long vector#
  people.cdf = cumsum(people.freq_v$value)#
  age.cdf = cumsum(age.freq)#
  success = 0#
  #start sampling#
  for (i in 1:rounds){#
    #let draw n people from the distribution#
    a_group_of_people = (simulate_a_group_of_people(n))#
    our_person = a_group_of_people[1] # we decided arbitrarly that the person of interest is always first#
    z = length(grep(our_person, a_group_of_people))#
    if (z == 1) {#
      success = success + 1#
    }#
  }#
  return(success/rounds)#
}
test_venter(100,2)
s = test_venter(100,2)
1100/24
1070/23
1060/22
205*25
1160/21
45+89+183+125
2017-44
200*25
130*30
370*30
41638/12
41638/11
3785.273*12
700/12
600/12
636/11
626/11
600/11
580/11
580/9
10^-5
.00001
.0001
7000*.0001
514+111
625+282
907/5
407/5
700000/40000000
12/44
24/44
44/2
12627/44993
44993/12627
44993/2000
7780
5500 + 3300
119(31)
119*31
.0005
.0005 * 10000
60+3+1+1+2+2
3350-900
7800-3300
1200/26
10+29.58+27.01
10+29.58+27.01+76+48.75
191.34/2
10+27.01+76+48.75
161.76/2
551894/110379
551894/110378
11.0959/2
11.0959/10.5408
1+401+401+201
1+401+201
11.0959/10000
0.00110959*551894
4594*0.01088376
22970* 0.01088376
22970* 0.01088376/5
0.01088376/5
1200/17
110379*5
10000/6
100000/6
13/254
4680+150
20*30
0.005441881*2
.441/.263
.323/.217
setwd("/Users/vicentediegoortegadelvecchyo/Dropbox/Documents/DissertationThesis/PurifyingSelection/Drafts/HaplotypeDFEStandingVariation/Figures")#
#
library(viridis)#
library(jpeg)#
library(plotrix)#
#
DemScenario <- c()#
DemScenario <- c(DemScenario,"AncientBottleneck")#
DemScenario <- c(DemScenario,"AncientBottleneckPointFivePercent")#
DemScenario <- c(DemScenario,"ConstantPopSize")#
DemScenario <- c(DemScenario,"ConstantPopSizePointFivePercent")#
DemScenario <- c(DemScenario,"MediumBottleneck")#
DemScenario <- c(DemScenario,"MediumBottleneckPointFivePercent")#
DemScenario <- c(DemScenario,"PopExpansion")#
DemScenario <- c(DemScenario,"PopExpansionPointFivePercent")#
DemScenario <- c(DemScenario,"RecentBottleneck")#
DemScenario <- c(DemScenario,"RecentBottleneckPointFivePercent")#
DemScenario <- c(DemScenario,"ConstantPopSizePopFrequency")#
DemScenario <- c(DemScenario,"UK10K")#
#
Selection <- c()#
Selection <- c(Selection,"4Ns0")#
Selection <- c(Selection,"4Ns-25")#
Selection <- c(Selection,"4Ns-50")#
Selection <- c(Selection,"4Ns25")#
Selection <- c(Selection,"4Ns50")#
#
SelectionTraj <- c()#
SelectionTraj <- c(Selection,"4Ns0")#
SelectionTraj <- c(Selection,"4Ns-25")#
SelectionTraj <- c(Selection,"4Ns-50")#
SelectionTraj <- c(Selection,"4Ns25")#
SelectionTraj <- c(Selection,"4Ns50")#
#
SelectionTest <- c()#
SelectionTest <- c(SelectionTest,"4Ns_0")#
SelectionTest <- c(SelectionTest,"4Ns_-25")#
SelectionTest <- c(SelectionTest,"4Ns_-50")#
SelectionTest <- c(SelectionTest,"4Ns_25")#
SelectionTest <- c(SelectionTest,"4Ns_50")#
#
SelectionTestAge <- c()#
SelectionTestAge <- c(SelectionTestAge,"4Ns_0")#
SelectionTestAge <- c(SelectionTestAge,"4Ns_-25")#
SelectionTestAge <- c(SelectionTestAge,"4Ns_-50")#
SelectionTestAge <- c(SelectionTestAge,"4Ns_25")#
SelectionTestAge <- c(SelectionTestAge,"4Ns_50")#
ListMaxFreq <- c()#
ListMaxAge <- c()#
ListMaxT2 <- c()#
#
Ne <- c()#
Ne[1]=10000#
Ne[2]=10000#
Ne[3]=20000#
Ne[4]=20000#
Ne[5]=10000#
Ne[6]=10000#
Ne[7]=100000#
Ne[8]=100000#
Ne[9]=10000#
Ne[10]=10000#
Ne[11]=20000#
Ne[12]=346884#
XLimFigureOne <- c()#
XLimFigureOne[1]=2500#
XLimFigureOne[2]=2500#
XLimFigureOne[3]=1000#
XLimFigureOne[4]=1000#
XLimFigureOne[5]=2500#
XLimFigureOne[6]=2500#
XLimFigureOne[7]=3500#
XLimFigureOne[8]=3500#
XLimFigureOne[9]=3500#
XLimFigureOne[10]=3500#
XLimFigureOne[11]=1000#
XLimFigureOne[12]=2000#
#
XLimFigureTwo <- c()#
XLimFigureTwo[1]=1500#
XLimFigureTwo[2]=900#
XLimFigureTwo[3]=3000#
XLimFigureTwo[4]=2000#
XLimFigureTwo[5]=1500#
XLimFigureTwo[6]=900#
XLimFigureTwo[7]=1750#
XLimFigureTwo[8]=1000#
XLimFigureTwo[9]=2000#
XLimFigureTwo[10]=900#
XLimFigureTwo[11]=3000#
XLimFigureTwo[12]=2500#
YLimFigureTwo <- c()#
YLimFigureTwo[1]=0.225#
YLimFigureTwo[2]=0.3#
YLimFigureTwo[3]=0.125#
YLimFigureTwo[4]=0.175#
YLimFigureTwo[5]=0.2#
YLimFigureTwo[6]=0.3#
YLimFigureTwo[7]=0.275#
YLimFigureTwo[8]=0.325#
YLimFigureTwo[9]=0.35#
YLimFigureTwo[10]=0.5#
YLimFigureTwo[11]=0.125#
YLimFigureTwo[12]=0.125#
#
XLimFigureThree <- c()#
XLimFigureThree[1]=350#
XLimFigureThree[2]=150#
XLimFigureThree[3]=650#
XLimFigureThree[4]=400#
XLimFigureThree[5]=300#
XLimFigureThree[6]=150#
XLimFigureThree[7]=400#
XLimFigureThree[8]=300#
XLimFigureThree[9]=300#
XLimFigureThree[10]=150#
XLimFigureThree[11]=650#
XLimFigureThree[12]=200#
for (j in 12:12){#
	print(DemScenario[j])#
	MaxFreq <- 0#
	for (i in 1:5){#
		TrajectoryFile <- paste("../Results/FrequencyTrajectories/OutMeanTraj",DemScenario[j],SelectionTraj[i],".txt",sep="")#
		Data <- read.table(TrajectoryFile)#
		MaxFreq <- max(MaxFreq,Data$V2)#
		print(MaxFreq)#
	}#
	ListMaxFreq <- c(ListMaxFreq,MaxFreq)#
	MaxAge <- 0#
	TrajectoryFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[1],".txt",sep="")#
	Data <- read.table(TrajectoryFile)#
	Max <- max(density(Data$V1*Ne[j]*2,from=0,to=quantile(Data$V1*Ne[j]*2,0.99))$x)#
	for (i in 1:5){#
		TrajectoryFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[i],".txt",sep="")#
		Data <- read.table(TrajectoryFile)#
		MaxAge <- max(MaxAge,(density(Data$V1*Ne[j]*2,from=0,to=Max)$y))#
		print(MaxAge)#
	}#
	ListMaxAge <- c(ListMaxAge,MaxAge)#
	MaxT2 <- 0#
	for (i in 1:5){#
		TrajectoryFile <- paste("../Results/TTwos/",DemScenario[j],"_",SelectionTest[i],".txt",sep="")#
		Data <- read.table(TrajectoryFile)#
		MaxT2 <- max(MaxT2,Data$V2)#
		print(MaxT2)#
	}#
	ListMaxT2 <- c(ListMaxT2,MaxT2)	#
}#
############################################################################ Only three figures #
#
for (j in 12:12){#
	Plot <- paste("../Figures/Figure8_UK10KFreqAgeT2.pdf",sep="")#
	pdf(Plot,width=28/1.6,height=7/1.55)#
	par(mfrow=c(1,4))#
	par(mar=c(5,5,5,2) + 0.1)#
############### Population scenarios#
	if (j==12){#
		plot(c(100000,100000-61,100000-(61+229),100000-(61+229+352),100000-(61+229+352+1221),100000-(61+229+352+1221+22971)),c(220758/2,2674/2,1171/2,9109/2,4594/2,14600/2),type="s",xlim=c(100000-3000,100000),ylim=c(0,220758/2),ylab="Effective Population Size",xlab="Time before the present",main="A) UK10K Model",xaxt='n',yaxt='n',cex.main=2.5,cex.lab=2.5,col="red",lwd=6)#
		axis(1,at=c(100000,100000-1000,100000-2000,100000-3000,100000-4000,100000-5000,100000-6000),labels = c("Present","1000","2000","3000","4000","5000","6000"),cex.axis=2.5)#
		axis(2,at=c(150000,100000,50000,0),labels = c("150000","100000","50000","0"),cex.axis=2.5)#
	}	#
############## Trajectories#
par(mar=c(5,5,5,2) + 0.1)#
#
	TrajectoryFile <- paste("../Results/FrequencyTrajectories/OutMeanTraj",DemScenario[j],SelectionTraj[1],".txt",sep="")#
	Data <- read.table(TrajectoryFile)#
	ColorViridis <- viridis(5)#
	ColorViridisAlpha <- viridis(5,alpha=0.6)#
	Color <- col2rgb("black")#
	if (j==7 || j==8){#
		plot(Data$V1[5000:1],Data$V2[1:5000],xlab="Time before the present",ylab="Mean Allele Frequency",type="l",xlim=c(XLimFigureOne[j],5000),ylim=c(0,ListMaxFreq[1]*1.3),main="B) Average Frequency \nTrajectory",xaxt="n",cex.lab=2.5,cex.main=2.5,cex.axis=2.5,lwd=6,col=ColorViridis[3])#
	}else{#
		plot(Data$V1[5000:1],Data$V2[1:5000],xlab="Time before the present",ylab="Mean Allele Frequency",type="l",xlim=c(XLimFigureOne[j],5000),ylim=c(0,ListMaxFreq[1]),main="B) Average Frequency \nTrajectory",xaxt="n",cex.lab=2.5,cex.main=2.5,cex.axis=2.5,lwd=6,col=ColorViridis[3])#
	}#
#lines(Data$V1[5000:1],Data$V3[1:5000],lty=3)#
#lines(Data$V1[5000:1],Data$V4[1:5000],lty=3)#
#lines(Data$V1[10000:1],ISData$V2[1:10000],lwd=10,col=rgb(Color[1,1],Color[2,1],Color[3,1],100,maxColorValue=255))#
	if (j==7 || j==8){#
	abline(v=5000-100,lty=3,cex=3,lwd=3)#
	}#
	if (j==1 || j==2){#
		abline(v=5000-5000,lty=3,lwd=3)#
		abline(v=5000-5200,lty=3,lwd=3)#
	}#
	if (j==5 || j==6){#
		abline(v=5000-2000,lty=3,lwd=3)#
		abline(v=5000-2200,lty=3,lwd=3)#
	}#
	if (j==9 || j==10){#
		abline(v=5000-100,lty=3,cex=3,lwd=3)#
		abline(v=5000-300,lty=3,cex=3,lwd=3)#
	}#
	if (j==9 || j==10){#
		abline(v=5000-100,lty=3,cex=3,lwd=3)#
		abline(v=5000-300,lty=3,cex=3,lwd=3)#
	}#
	if (j==12){#
		abline(v=5000-61,lty=3,cex=3,lwd=3)#
		abline(v=5000-(61+229),lty=3,cex=3,lwd=3)#
		abline(v=5000-(61+229+352),lty=3,cex=3,lwd=3)#
		abline(v=5000-(61+229+352+1221),lty=3,cex=3,lwd=3)#
		abline(v=5000-(61+229+352+1221),lty=3,cex=3,lwd=3)#
		abline(v=5000-(61+229+352+1221+22971),lty=3,cex=3,lwd=3)#
#
	}#
	TrajectoryFile <- paste("../Results/FrequencyTrajectories/OutMeanTraj",DemScenario[j],SelectionTraj[2],".txt",sep="")#
	Data <- read.table(TrajectoryFile)#
	Color <- col2rgb("purple")#
	lines(Data$V1[5000:1],Data$V2[1:5000],lwd=6,col=ColorViridis[2])#
#lines(Data$V1[5000:1],Data$V3[1:5000],lty=3,col="purple")#
#lines(Data$V1[5000:1],Data$V4[1:5000],lty=3,col="purple")#
#lines(Data$V1[10000:1],ISData$V3[1:10000],lwd=10,col=rgb(Color[1,1],Color[2,1],Color[3,1],100,maxColorValue=255))#
	TrajectoryFile <- paste("../Results/FrequencyTrajectories/OutMeanTraj",DemScenario[j],SelectionTraj[3],".txt",sep="")#
	Data <- read.table(TrajectoryFile)#
	Color <- col2rgb("orange")#
	lines(Data$V1[5000:1],Data$V2[1:5000],lwd=6,col=ColorViridis[1])#
#lines(Data$V1[5000:1],Data$V3[1:5000],lty=3,col="orange")#
#lines(Data$V1[5000:1],Data$V4[1:5000],lty=3,col="orange")#
#lines(Data$V1[10000:1],ISData$V4[1:10000],lwd=10,col=rgb(Color[1,1],Color[2,1],Color[3,1],100,maxColorValue=255))#
	TrajectoryFile <- paste("../Results/FrequencyTrajectories/OutMeanTraj",DemScenario[j],SelectionTraj[4],".txt",sep="")#
	Data <- read.table(TrajectoryFile)#
	lines(Data$V1[5000:1],Data$V2[1:5000],lty=5,lwd=6,col=ColorViridis[4])#
#lines(Data$V1[5000:1],Data$V3[1:5000],lty=3,col="red")#
#lines(Data$V1[5000:1],Data$V4[1:5000],lty=3,col="red")#
	TrajectoryFile <- paste("../Results/FrequencyTrajectories/OutMeanTraj",DemScenario[j],SelectionTraj[5],".txt",sep="")#
	Data <- read.table(TrajectoryFile)#
	lines(Data$V1[5000:1],Data$V2[1:5000],lty=5,lwd=6,col=ColorViridis[5])#
#lines(Data$V1[5000:1],Data$V3[1:5000],lty=3,col="dodgerblue")#
#lines(Data$V1[5000:1],Data$V4[1:5000],lty=3,col="dodgerblue")#
	if (j == 1 || j == 2 ){#
	legend("center",c("-100","-50","0","50","100"), lty=c(1,1,1,6,6),lwd=6,col=ColorViridis,cex=2,title=expression(paste(4,N[0],'s',sep="")),bty="n")#
	}else if( j == 5){#
	legend(5000-1500,0.0078,c("-100","-50","0","50","100"), lty=c(1,1,1,6,6),lwd=6,col=ColorViridis,cex=2,title=expression(paste(4,N[0],'s',sep="")),bty="n")#
	}else if( j == 6){#
		legend(5000-1600,0.0035,c("-100","-50","0","50","100"), lty=c(1,1,1,6,6),lwd=6,col=ColorViridis,cex=2,title=expression(paste(4,N[0],'s',sep="")),bty="n")#
	}else if( j == 9){#
		legend(5000-1500,0.017,c("-100","-50","0","50","100"), lty=c(1,1,1,6,6),lwd=6,col=ColorViridis,cex=2,title=expression(paste(4,N[0],'s',sep="")),bty="n")#
	}else if( j == 10){#
		legend(5000-1500,0.0065,c("-100","-50","0","50","100"), lty=c(1,1,1,6,6),lwd=6,col=ColorViridis,cex=2,title=expression(paste(4,N[0],'s',sep="")),bty="n")#
	}else if (j == 7 || j == 8 ){#
		legend("topleft",c("-100","-50","0","50","100"), lty=c(1,1,1,6,6),lwd=6,col=ColorViridis,cex=2,title=expression(paste(4,N[0],'s',sep="")),bty="n")	#
	}else if (j == 3 ||j == 4 ||j == 11){#
		legend("center",c("-100","-50","0","50","100"), lty=c(1,1,1,6,6),lwd=6,col=ColorViridis,cex=2,title=expression(paste(4,N,'s',sep="")),bty="n")#
	}#
#legend("topleft",c("0","-50","-100","50","100"),pch=19,col=c("black","purple","orange","red","dodgerblue"),cex=1.5,title="4Ns",bty="n")#
	axis(1,at=c(5000,4000,3000,1000,0),labels=c("Present","1000","2000","4000","5000"),cex.lab=2.5,cex.axis=2.5)#
	legend("topleft",c("-50","-25","0","25","50"), lty=c(1,1,1,6,6),lwd=6,col=ColorViridis,cex=1.2,title=expression(paste(4,N[0],'s',sep="")),bty="n")#
#
	par(mar=c(5,5,5,2) + 0.1)#
	AgesFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[1],".txt",sep="")#
	Data <- read.table(AgesFile)#
	Color <- col2rgb("black")#
	Max <- quantile(Data$V1*Ne[j]*2,0.99)#
	if (j==7){#
		Breaks <- seq(from=0,to=max(Data$V1*Ne[j]*2+50),by=50)#
		Histogram <- hist(Data$V1*2*Ne[j],breaks=Breaks,plot=FALSE)#
		XSubset <- subset(rev(density(Data$V1*Ne[j]*2,from=0,to=Max)$x),rev(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)<=XLimFigureTwo[j]*0.78 )#
		Length <- length(XSubset) - 1#
		MaxLength <- length(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)#
		plot(rev(c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.22*(XLimFigureTwo[j]),density(Data$V1*Ne[j]*2,from=0,to=Max)$x[(MaxLength-Length):(MaxLength)])),density(Data$V1*Ne[j]*2,from=0,to=Max)$y[1:(Length+2)],xlab="Allele Age",ylab="Probability",type="l",ylim=c(-0.2*ListMaxAge[1],ListMaxAge[1]),main="C) Allele Age",xaxt="n",yaxt="n",col=ColorViridis[3],cex.lab=2.5,cex.main=2.5,cex.axis=2.5,lwd=6,xlim=c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j],max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)))#
		SD <- sd(Data$V1*Ne[j]*2)#
		arrows(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j]+0.1*XLimFigureTwo[j],-0.12*ListMaxAge[1],min(Max- mean(Data$V1*Ne[j]*2)+SD,Max),-0.12*ListMaxAge[1], length=0.05, angle=90, code=3,col=ColorViridis[3],lwd=6)#
#		plot(max(Data$V1*Ne[j]*2) - 0:99*50,Histogram$counts[1:100]/sum(Histogram$counts),xlab="Allele Age",ylab="Probability",type="l",ylim=c(0,YLimFigureTwo[j]),main="B) Allele Age",xaxt="n",cex.lab=2,cex.main=2,cex.axis=1.5,lwd=6,xlim=c(max(density(Data$V1*Ne[j]*2,from=0)$x)-XLimFigureTwo[j],max(Data$V1*Ne[j]*2)))#
#		abline(v=mean(Max- Data$V1*Ne[j]*2),lwd=6,col=ColorViridisAlpha[3])#
		points(Max - mean(Data$V1*Ne[j]*2),-0.12*ListMaxAge[1],pch=20,col=ColorViridis[3],cex=3)#
		axis(2,at=c(0,0.002,0.004,0.006,0.008,0.01,0.012,0.014,0.016,0.018,0.02),labels=c("0","0.002","0.004","0.006","0.008","0.01","0.012","0.014","0.016","0.018","0.02"),cex.lab=2.5,cex.axis=2.5)#
## X values #
		XFirstValue <- max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x) - 0.8*XLimFigureTwo[j]#
		Threshold <- mean(Data$V1*Ne[j]*2) + SD-0.1*XLimFigureTwo[j]#
		SubsetXValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$x,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
		SubsetYValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$y,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
		YValuesToPrint <- c(density(Data$V1*Ne[j]*2,from=0,to=Max)$y[length(density(Data$V1*Ne[j]*2,from=0,to=Max)$y) - length(SubsetYValues)],SubsetYValues)#
		TransformedXValues <- SubsetXValues - Threshold#
		XValuesToPrint <- c(XFirstValue,XFirstValue-TransformedXValues)#
		lines(rev(c(XValuesToPrint)),YValuesToPrint,col=ColorViridis[3],lwd=6 )#
	}else{#
		Breaks <- seq(from=0,to=max(Data$V1*Ne[j]*2+50),by=50)#
		Histogram <- hist(Data$V1*2*Ne[j],breaks=Breaks,plot=FALSE)#
		XSubset <- subset(rev(density(Data$V1*Ne[j]*2,from=0,to=Max)$x),rev(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)<=XLimFigureTwo[j]*0.78 )#
		Length <- length(XSubset) - 1#
		MaxLength <- length(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)#
		plot(rev(c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.22*(XLimFigureTwo[j]),density(Data$V1*Ne[j]*2,from=0,to=Max)$x[(MaxLength-Length):(MaxLength)])),density(Data$V1*Ne[j]*2,from=0,to=Max)$y[1:(Length+2)],xlab="Allele Age",ylab="Probability",type="l",ylim=c(-0.2*ListMaxAge[1],ListMaxAge[1]),main="C) Allele Age",xaxt="n",yaxt="n",col=ColorViridis[3],cex.lab=2.5,cex.main=2.5,cex.axis=2.5,lwd=6,xlim=c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j],max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)))#
		SD <- sd(Data$V1*Ne[j]*2)#
		arrows(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j]+0.1*XLimFigureTwo[j],-0.12*ListMaxAge[1],min(Max- mean(Data$V1*Ne[j]*2)+SD,Max),-0.12*ListMaxAge[1], length=0.05, angle=90, code=3,col=ColorViridis[3],lwd=6)#
#		abline(v=mean(Max - Data$V1*Ne[j]*2),lwd=6,col=ColorViridisAlpha[3])#
		points(Max - mean(Data$V1*Ne[j]*2),-0.12*ListMaxAge[1],pch=20,col=ColorViridis[3],cex=3)#
#		plot(max(Data$V1*Ne[j]*2) - 0:99*50,Histogram$counts[1:100]/sum(Histogram$counts),xlab="Allele Age",ylab="Probability",type="l",ylim=c(0,YLimFigureTwo[j]),main="B) Allele Age",xaxt="n",cex.lab=2,cex.main=2,cex.axis=1.5,lwd=6,xlim=c(max(density(Data$V1*Ne[j]*2,from=0)$x)-XLimFigureTwo[j],max(Data$V1*Ne[j]*2)))#
		axis(2,at=c(0,0.002,0.004,0.006,0.008,0.01,0.012,0.014,0.016,0.018,0.02),labels=c("0","0.002","0.004","0.006","0.008","0.01","0.012","0.014","0.016","0.018","0.02"),cex.lab=2.5,cex.axis=2.5)#
## X values #
		XFirstValue <- max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x) - 0.8*XLimFigureTwo[j]#
		Threshold <- mean(Data$V1*Ne[j]*2) + SD-0.1*XLimFigureTwo[j]#
		SubsetXValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$x,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
		SubsetYValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$y,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
		YValuesToPrint <- c(density(Data$V1*Ne[j]*2,from=0,to=Max)$y[length(density(Data$V1*Ne[j]*2,from=0,to=Max)$y) - length(SubsetYValues)],SubsetYValues)#
		TransformedXValues <- SubsetXValues - Threshold#
		XValuesToPrint <- c(XFirstValue,XFirstValue-TransformedXValues)#
		lines(rev(c(XValuesToPrint)),YValuesToPrint,col=ColorViridis[3],lwd=6 )#
	}#
	if (j==7 || j==8){#
#		abline(v=max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-100,lty=3,lwd=3)#
		segments(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-100,0,max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-100,100,lty=3,lwd=3)#
	}#
	if (j==1 || j==2){#
#		abline(v=max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-5000,lty=3,lwd=3)#
#		abline(v=max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-5200,lty=3,lwd=3)#
		segments(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-5000,0,max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-5000,100,lty=3,lwd=3)#
		segments(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-5200,0,max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-5200,300,lty=3,lwd=3)#
	}#
	if (j==5 || j==6){#
#		abline(v=max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-2000,lty=3,lwd=3)#
#		abline(v=max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-2200,lty=3,lwd=3)#
		segments(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-2000,0,max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-2000,100,lty=3,lwd=3)#
		segments(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-2200,0,max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-2200,300,lty=3,lwd=3)#
	}#
	if (j==9 || j==10){#
#		abline(v=max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-100,lty=3,lwd=3)#
#		abline(v=max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-300,lty=3,lwd=3)#
		segments(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-100,0,max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-100,100,lty=3,lwd=3)#
		segments(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-300,0,max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-300,300,lty=3,lwd=3)#
	}#
	ValueToPrintXAxis <- round(mean(Data$V1*Ne[j]*2)+SD)#
	AgesFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[2],".txt",sep="")#
	Data <- read.table(AgesFile)#
	Breaks <- seq(from=0,to=max(Data$V1*Ne[j]*2+50),by=50)#
	Histogram <- hist(Data$V1*2*Ne[j],breaks=Breaks,plot=FALSE)#
	Color <- col2rgb("purple")#
# lines(Max  - 0:99*50,Histogram$counts[1:100]/sum(Histogram$counts),col="purple",lwd=6)#
	lines(rev(c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.22*(XLimFigureTwo[j]),density(Data$V1*Ne[j]*2,from=0,to=Max)$x[(MaxLength-Length):(MaxLength)])),density(Data$V1*Ne[j]*2,from=0,to=Max)$y[1:(Length+2)],col=ColorViridis[2],lwd=6)#
	SD <- sd(Data$V1*Ne[j]*2)#
	arrows(Max- mean(Data$V1*Ne[j]*2)-SD,-0.08*ListMaxAge[1],min(Max- mean(Data$V1*Ne[j]*2)+SD,Max),-0.08*ListMaxAge[1], length=0.05, angle=90, code=3,col=ColorViridis[2],lwd=6)#
## X values #
	XFirstValue <- max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x) - 0.8*XLimFigureTwo[j]#
	Threshold <- mean(Data$V1*Ne[j]*2) + SD-0.1*XLimFigureTwo[j]#
	SubsetXValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$x,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
	SubsetYValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$y,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
	YValuesToPrint <- c(density(Data$V1*Ne[j]*2,from=0,to=Max)$y[length(density(Data$V1*Ne[j]*2,from=0,to=Max)$y) - length(SubsetYValues)],SubsetYValues)#
	TransformedXValues <- SubsetXValues - Threshold#
	XValuesToPrint <- c(XFirstValue,XFirstValue-TransformedXValues)#
#	Check <- length(subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$x,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > (mean(Data$V1*Ne[j]*2)+SD - 0.1*XLimFigureTwo[j])))#
#	StartingYValue <- length(density(Data$V1*Ne[j]*2,from=0,to=Max)$x) - Check#
	lines(rev(c(XValuesToPrint)),YValuesToPrint,col=ColorViridis[2],lwd=6 )#
#	abline(v=mean(Max - Data$V1*Ne[j]*2),lwd=6,col=ColorViridisAlpha[2])#
	points(Max - mean(Data$V1*Ne[j]*2),-0.08*ListMaxAge[1],pch=20,col=ColorViridis[2],cex=3)#
	AgesFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[3],".txt",sep="")#
	Data <- read.table(AgesFile)#
	Breaks <- seq(from=0,to=max(Data$V1*Ne[j]*2+50),by=50)#
	Histogram <- hist(Data$V1*2*Ne[j],breaks=Breaks,plot=FALSE)#
	Color <- col2rgb("orange")#
#lines(Max  - 0:99*50,Histogram$counts[1:100]/sum(Histogram$counts),col="orange",lwd=6)#
	lines(rev(c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.22*(XLimFigureTwo[j]),density(Data$V1*Ne[j]*2,from=0,to=Max)$x[(MaxLength-Length):(MaxLength)])),density(Data$V1*Ne[j]*2,from=0,to=Max)$y[1:(Length+2)],col=ColorViridis[1],lwd=6)#
	SD <- sd(Data$V1*Ne[j]*2)#
	arrows(Max- mean(Data$V1*Ne[j]*2)-SD,-0.04*ListMaxAge[1],min(Max- mean(Data$V1*Ne[j]*2)+SD,Max),-0.04*ListMaxAge[1], length=0.05, angle=90, code=3,col=ColorViridis[1],lwd=6)#
## X values #
	XFirstValue <- max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x) - 0.8*XLimFigureTwo[j]#
	Threshold <- mean(Data$V1*Ne[j]*2) + SD-0.1*XLimFigureTwo[j]#
	SubsetXValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$x,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
	SubsetYValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$y,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
	YValuesToPrint <- c(density(Data$V1*Ne[j]*2,from=0,to=Max)$y[length(density(Data$V1*Ne[j]*2,from=0,to=Max)$y) - length(SubsetYValues)],SubsetYValues)#
	TransformedXValues <- SubsetXValues - Threshold#
	XValuesToPrint <- c(XFirstValue,XFirstValue-TransformedXValues)#
#	Check <- length(subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$x,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > (mean(Data$V1*Ne[j]*2)+SD - 0.1*XLimFigureTwo[j])))#
#	StartingYValue <- length(density(Data$V1*Ne[j]*2,from=0,to=Max)$x) - Check#
	lines(rev(c(XValuesToPrint)),YValuesToPrint,col=ColorViridis[1],lwd=6 )#
#abline(v=mean(Max - Data$V1*Ne[j]*2),lwd=6,col=ColorViridisAlpha[1])#
	points(Max - mean(Data$V1*Ne[j]*2),-0.04*ListMaxAge[1],pch=20,col=ColorViridis[1],cex=3)#
	AgesFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[4],".txt",sep="")#
	Data <- read.table(AgesFile)#
	Breaks <- seq(from=0,to=max(Data$V1*Ne[j]*2+50),by=50)#
	Histogram <- hist(Data$V1*2*Ne[j],breaks=Breaks,plot=FALSE)#
#lines(Max  - 0:99*50,Histogram$counts[1:100]/sum(Histogram$counts),col="red",lty=5,lwd=6)#
	lines(rev(c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.22*(XLimFigureTwo[j]),density(Data$V1*Ne[j]*2,from=0,to=Max)$x[(MaxLength-Length):(MaxLength)])),density(Data$V1*Ne[j]*2,from=0,to=Max)$y[1:(Length+2)],lty=5,col=ColorViridis[4],lwd=6)#
#abline(v=mean(Max - Data$V1*Ne[j]*2),lty=5,lwd=6,col=ColorViridisAlpha[4])#
	SD <- sd(Data$V1*Ne[j]*2)#
	arrows(Max- mean(Data$V1*Ne[j]*2)-SD,-0.16*ListMaxAge[1],min(Max- mean(Data$V1*Ne[j]*2)+SD,Max),-0.16*ListMaxAge[1], length=0.05, angle=90, code=3,col=ColorViridis[4],lwd=6)#
## X values #
	XFirstValue <- max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x) - 0.8*XLimFigureTwo[j]#
	Threshold <- mean(Data$V1*Ne[j]*2) + SD-0.1*XLimFigureTwo[j]#
	SubsetXValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$x,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
	SubsetYValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$y,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
	YValuesToPrint <- c(density(Data$V1*Ne[j]*2,from=0,to=Max)$y[length(density(Data$V1*Ne[j]*2,from=0,to=Max)$y) - length(SubsetYValues)],SubsetYValues)#
	TransformedXValues <- SubsetXValues - Threshold#
	XValuesToPrint <- c(XFirstValue,XFirstValue-TransformedXValues)#
#	Check <- length(subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$x,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > (mean(Data$V1*Ne[j]*2)+SD - 0.1*XLimFigureTwo[j])))#
#	StartingYValue <- length(density(Data$V1*Ne[j]*2,from=0,to=Max)$x) - Check#
	lines(rev(c(XValuesToPrint)),YValuesToPrint,col=ColorViridis[4],lwd=6 ,lty=5)#
	points(Max - mean(Data$V1*Ne[j]*2),-0.16*ListMaxAge[1],pch=20,col=ColorViridis[4],cex=3)#
	AgesFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[5],".txt",sep="")#
	Data <- read.table(AgesFile)#
	Breaks <- seq(from=0,to=max(Data$V1*Ne[j]*2+50),by=50)#
	Histogram <- hist(Data$V1*2*Ne[j],breaks=Breaks,plot=FALSE)#
#lines(Max  - 0:99*50,Histogram$counts[1:100]/sum(Histogram$counts),col="dodgerblue",lty=5,lwd=6)#
	lines(rev(c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.22*(XLimFigureTwo[j]),density(Data$V1*Ne[j]*2,from=0,to=Max)$x[(MaxLength-Length):(MaxLength)])),density(Data$V1*Ne[j]*2,from=0,to=Max)$y[1:(Length+2)],lty=5,col=ColorViridis[5],lwd=6)#
	SD <- sd(Data$V1*Ne[j]*2)#
	arrows(Max- mean(Data$V1*Ne[j]*2)-SD,-0.2*ListMaxAge[1],min(Max- mean(Data$V1*Ne[j]*2)+SD,Max),-0.2*ListMaxAge[1], length=0.05, angle=90, code=3,col=ColorViridis[5],lwd=6)#
## X values #
	XFirstValue <- max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x) - 0.8*XLimFigureTwo[j]#
	Threshold <- mean(Data$V1*Ne[j]*2) + SD-0.1*XLimFigureTwo[j]#
	SubsetXValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$x,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
	SubsetYValues <- subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$y,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > Threshold)#
	YValuesToPrint <- c(density(Data$V1*Ne[j]*2,from=0,to=Max)$y[length(density(Data$V1*Ne[j]*2,from=0,to=Max)$y) - length(SubsetYValues)],SubsetYValues)#
	TransformedXValues <- SubsetXValues - Threshold#
	XValuesToPrint <- c(XFirstValue,XFirstValue-TransformedXValues)#
#	Check <- length(subset(density(Data$V1*Ne[j]*2,from=0,to=Max)$x,density(Data$V1*Ne[j]*2,from=0,to=Max)$x > (mean(Data$V1*Ne[j]*2)+SD - 0.1*XLimFigureTwo[j])))#
#	StartingYValue <- length(density(Data$V1*Ne[j]*2,from=0,to=Max)$x) - Check#
	lines(rev(c(XValuesToPrint)),YValuesToPrint,col=ColorViridis[5],lwd=6,lty=5 )#
	points(Max - mean(Data$V1*Ne[j]*2),-0.2*ListMaxAge[1],pch=20,col=ColorViridis[5],cex=3)#
#	legend("topleft",c("-100","-50","0","50","100"), lty=c(1,1,1,6,6),lwd=6,col=ColorViridis,cex=2,title="4Ns",bty="n")#
#	XLimFigureTwo[1]=1500#
#	XLimFigureTwo[2]=900#
#	XLimFigureTwo[3]=3000#
#	XLimFigureTwo[4]=2000#
#	XLimFigureTwo[5]=1500#
#	XLimFigureTwo[6]=900#
#	XLimFigureTwo[7]=1750#
#	XLimFigureTwo[8]=1000#
#	XLimFigureTwo[9]=2000#
#	XLimFigureTwo[10]=900#
#	XLimFigureTwo[11]=3000#
	if (XLimFigureTwo[j] <= 1000){#
		axis(1,at=c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.1*(XLimFigureTwo[j]),Max-500,Max-250,Max),labels=c(ValueToPrintXAxis,"500","250","Present"),cex.lab=2.5,cex.axis=2.5)#
	}else if (XLimFigureTwo[j] <= 1500){#
		axis(1,at=c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.1*(XLimFigureTwo[j]),Max-1000,Max-500,Max),labels=c(ValueToPrintXAxis,"1000","500","Present"),cex.lab=2.5,cex.axis=2.5)#
	}else if (XLimFigureTwo[j] <= 1750){#
		axis(1,at=c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.1*(XLimFigureTwo[j]),Max-1000,Max-500,Max),labels=c(ValueToPrintXAxis,"1000","500","Present"),cex.lab=2.5,cex.axis=2.5)#
	}else if (XLimFigureTwo[j] <= 2000){#
		axis(1,at=c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.1*(XLimFigureTwo[j]),Max-1500,Max-1000,Max-500,Max),labels=c(ValueToPrintXAxis,"1500","1000","500","Present"),cex.lab=2.5,cex.axis=2.5)#
	}else if (XLimFigureTwo[j] <= 3000){#
		axis(1,at=c(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.1*(XLimFigureTwo[j]),Max-4000,Max-3000,Max-2000,Max-1000,Max),labels=c(ValueToPrintXAxis,"4000","3000","2000","1000","Present"),cex.lab=2.5,cex.axis=2.5)#
	}#
#	axis(1,at=c(Max-2500,Max-2000,Max-1500,Max-1000,Max-500,Max),labels=c("2500","2000","1500","1000","500","Present"),cex.lab=2,cex.axis=2)#
#	rect(max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j]+10,-0.02*ListMaxAge[j],max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j]+0.2*(XLimFigureTwo[j]),ListMaxAge[j],col="white",border=NA)#
	Color <- col2rgb("black")#
	axis.break(1, max(density(Data$V1*Ne[j]*2,from=0,to=Max)$x)-XLimFigureTwo[j] + 0.2*(XLimFigureTwo[j]), style = "gap")#
#
	AgesFile <- paste("../Results/TTwos/",DemScenario[j],"_",SelectionTest[1],".txt",sep="")#
	Data <- read.table(AgesFile)#
#
    par(mar=c(5,5,5,3) + 0.1)#
#
	plot(Data$V1[XLimFigureThree[j]:1],Data$V2[1:XLimFigureThree[j]],xlab=expression(bold(T[2])),ylab="Probability",type="l",main=expression(bold(paste("D) ",T[2],sep=""))),ylim=c(-0.2*ListMaxT2[1],1.05*ListMaxT2[1]),xaxt="n",yaxt="n",cex.lab=2.5,cex.main=2.5,cex.axis=2.5,lwd=6,col=ColorViridis[3])#
#,ylim=c(0,1.0)#
	if (j==7 || j==8){#
#		abline(v=Data$V1[XLimFigureThree[j]]-100,lty=3,lwd=3)#
		segments(Data$V1[XLimFigureThree[j]]-100,0,Data$V1[XLimFigureThree[j]]-100,100,lty=3,lwd=3)#
	}#
	if (j==1 || j==2){#
#		abline(v=Data$V1[XLimFigureThree[j]]-5000,lty=3,lwd=3)#
#		abline(v=Data$V1[XLimFigureThree[j]]-5200,lty=3,lwd=3)#
		segments(Data$V1[XLimFigureThree[j]]-5000,0,Data$V1[XLimFigureThree[j]]-5000,100,lty=3,lwd=3)#
		segments(Data$V1[XLimFigureThree[j]]-5200,0,Data$V1[XLimFigureThree[j]]-5200,300,lty=3,lwd=3)#
	}#
	if (j==5 || j==6){#
#		abline(v=Data$V1[XLimFigureThree[j]]-2000,lty=3,lwd=3)#
#		abline(v=Data$V1[XLimFigureThree[j]]-2200,lty=3,lwd=3)#
		segments(Data$V1[XLimFigureThree[j]]-2000,0,Data$V1[XLimFigureThree[j]]-2000,100,lty=3,lwd=3)#
		segments(Data$V1[XLimFigureThree[j]]-2200,0,Data$V1[XLimFigureThree[j]]-2200,300,lty=3,lwd=3)#
	}#
	if (j==9 || j==10){#
#		abline(v=Data$V1[XLimFigureThree[j]]-100,lty=3,lwd=3)#
#		abline(v=Data$V1[XLimFigureThree[j]]-300,lty=3,lwd=3)#
		segments(Data$V1[XLimFigureThree[j]]-100,0,Data$V1[XLimFigureThree[j]]-100,100,lty=3,lwd=3)#
		segments(Data$V1[XLimFigureThree[j]]-300,0,Data$V1[XLimFigureThree[j]]-100,300,lty=3,lwd=3)#
	}#
	SD <- (sum(Data$V1*Data$V1*Data$V2) - sum(Data$V1*Data$V2)*sum(Data$V1*Data$V2))^(1/2)#
	arrows(XLimFigureThree[j]- sum(Data$V1*Data$V2)-SD,-0.12*ListMaxT2[1],min(XLimFigureThree[j]- sum(Data$V1*Data$V2)+SD,XLimFigureThree[j]),-0.12*ListMaxT2[1], length=0.05, angle=90, code=3,col=ColorViridis[3],lwd=6)#
	points(XLimFigureThree[j]- sum(Data$V1*Data$V2),-0.12*ListMaxT2[1],pch=20,col=ColorViridis[3],cex=3)#
	AgesFile <- paste("../Results/TTwos/",DemScenario[j],"_",SelectionTest[2],".txt",sep="")#
	Data <- read.table(AgesFile)#
	Color <- col2rgb("purple")#
	lines(Data$V1[XLimFigureThree[j]:1],Data$V2[1:XLimFigureThree[j]],col=ColorViridis[2],lwd=6)#
	SD <- (sum(Data$V1*Data$V1*Data$V2) - sum(Data$V1*Data$V2)*sum(Data$V1*Data$V2))^(1/2)#
	arrows(XLimFigureThree[j]- sum(Data$V1*Data$V2)-SD,-0.08*ListMaxT2[1],min(XLimFigureThree[j]- sum(Data$V1*Data$V2)+SD,XLimFigureThree[j]),-0.08*ListMaxT2[1], length=0.05, angle=90, code=3,col=ColorViridis[2],lwd=6)#
	points(XLimFigureThree[j]- sum(Data$V1*Data$V2),-0.08*ListMaxT2[1],pch=20,col=ColorViridis[2],cex=3)#
	AgesFile <- paste("../Results/TTwos/",DemScenario[j],"_",SelectionTest[3],".txt",sep="")#
	Data <- read.table(AgesFile)#
	Color <- col2rgb("orange")#
	lines(Data$V1[XLimFigureThree[j]:1],Data$V2[1:XLimFigureThree[j]],col=ColorViridis[1],lwd=6)#
	SD <- (sum(Data$V1*Data$V1*Data$V2) - sum(Data$V1*Data$V2)*sum(Data$V1*Data$V2))^(1/2)#
	arrows(XLimFigureThree[j]- sum(Data$V1*Data$V2)-SD,-0.04*ListMaxT2[1],min(XLimFigureThree[j]- sum(Data$V1*Data$V2)+SD,XLimFigureThree[j]),-0.04*ListMaxT2[1], length=0.05, angle=90, code=3,col=ColorViridis[1],lwd=6)#
	points(XLimFigureThree[j]- sum(Data$V1*Data$V2),-0.04*ListMaxT2[1],pch=20,col=ColorViridis[1],cex=3)#
	AgesFile <- paste("../Results/TTwos/",DemScenario[j],"_",SelectionTest[4],".txt",sep="")#
	Data <- read.table(AgesFile)#
	lines(Data$V1[XLimFigureThree[j]:1],Data$V2[1:XLimFigureThree[j]],col=ColorViridis[4],lty=5,lwd=6)#
	SD <- (sum(Data$V1*Data$V1*Data$V2) - sum(Data$V1*Data$V2)*sum(Data$V1*Data$V2))^(1/2)#
	arrows(XLimFigureThree[j]- sum(Data$V1*Data$V2)-SD,-0.16*ListMaxT2[1],min(XLimFigureThree[j]- sum(Data$V1*Data$V2)+SD,XLimFigureThree[j]),-0.16*ListMaxT2[1], length=0.05, angle=90, code=3,col=ColorViridis[4],lwd=6)#
	points(XLimFigureThree[j]- sum(Data$V1*Data$V2),-0.16*ListMaxT2[1],pch=20,col=ColorViridis[4],cex=3)#
	AgesFile <- paste("../Results/TTwos/",DemScenario[j],"_",SelectionTest[5],".txt",sep="")#
	Data <- read.table(AgesFile)#
	lines(Data$V1[XLimFigureThree[j]:1],Data$V2[1:XLimFigureThree[j]],col=ColorViridis[5],lty=5,lwd=6)#
	SD <- (sum(Data$V1*Data$V1*Data$V2) - sum(Data$V1*Data$V2)*sum(Data$V1*Data$V2))^(1/2)#
	arrows(XLimFigureThree[j]- sum(Data$V1*Data$V2)-SD,-0.2*ListMaxT2[1],min(XLimFigureThree[j]- sum(Data$V1*Data$V2)+SD,XLimFigureThree[j]),-0.2*ListMaxT2[1], length=0.05, angle=90, code=3,col=ColorViridis[5],lwd=6)#
	points(XLimFigureThree[j]- sum(Data$V1*Data$V2),-0.2*ListMaxT2[1],pch=20,col=ColorViridis[5],cex=3)#
#legend("topleft",c("0","-50","-100","50","100"),pch=19,col=c("black","purple","orange","red","dodgerblue"),cex=1.5,title="4Ns",bty="n")#
	axis(1,at=c(XLimFigureThree[j]-700,XLimFigureThree[j]-600,XLimFigureThree[j]-500,XLimFigureThree[j]-400,XLimFigureThree[j]-300,XLimFigureThree[j]-200,XLimFigureThree[j]-100,XLimFigureThree[j]),labels=c("700","600","500","400","300","200","100","Present"),cex.lab=2.5,cex.axis=2.5)#
	axis(2,at=c(0,0.005,0.01,0.015,0.02,0.025,0.03,0.035,0.04),labels=c("0","0.005","0.01","0.015","0.02","0.025","0.03","0.035","0.04"),cex.lab=2.5,cex.axis=2.5)#
	dev.off()#
}
AgesFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[2],".txt",sep="")#
	Data <- read.table(AgesFile)
mean(Data$V1*Ne[j]*2)
AgesFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[1],".txt",sep="")#
	Data <- read.table(AgesFile)
mean(Data$V1*Ne[j]*2)
AgesFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[3],".txt",sep="")#
	Data <- read.table(AgesFile)
mean(Data$V1*Ne[j]*2)
AgesFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[4],".txt",sep="")#
	Data <- read.table(AgesFile)
mean(Data$V1*Ne[j]*2)
AgesFile <- paste("../Results/AlleleAges/Ages",DemScenario[j],"_",SelectionTestAge[5],".txt",sep="")#
	Data <- read.table(AgesFile)
mean(Data$V1*Ne[j]*2)
227*39
227*30
227*25
920*236/150
219730*5
219730*5/2
4594*5/2
9109*5/2
1171*5/2
2852*5/2
290*5/2
290*5
549326*2/5
236/150*920
236/151*920
236/150*920
237/150*920
303/1450
920*0.2089655
4594 22971#
9109 1221#
1171 352#
2852 228#
219730 62
219730*236/150
219730*5/2
220758*5/2
2674*5/2
38*5
252+38
1450/290
38/290
192/5
303/5
62*5
61*5
