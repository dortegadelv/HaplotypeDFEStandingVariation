
// set up a simple neutral simulation
initialize() {
    initializeMutationRate(1.2e-08*(2.31/3.31)*5);
    initializeTreeSeq();

    // m1 mutation type: nonsyn
    // muts added at 2.31/3.31 the mutation rate, syn muts added w/msprime
    initializeMutationType("m1", 0, "f", 0.0);

    // m2 mutation type: adaptive
    initializeMutationType("m2", 0.5, "s", "return runif(1,0.00125, 0.0125);");
    m2.convertToSubstitution == T;

    // m3 mutation type: cnc with DFE from Torgerson et al., 2009
    // initializeMutationType("m3", 0.5, "g", -0.004594*5, 0.0415);
    // m3.convertToSubstitution == T;

    //genomic element: exon and uses a mixture of syn and nonsyn at a 1:2.31 ratio (Huber et al.)
    initializeGenomicElementType("g1", c(m1), c(1.0)); // no synonymous muts

    //genomic element: cnc
    // initializeGenomicElementType("g2", c(m3), c(1.0));

    //read in exon and recomb info
    info_lines = readFile("/project2/jnovembre/diegoortega/HaplotypeDFEStandingVariation/Scripts/Sims/SLiM/PopExpansion/PopExpansionConstantRecRate/sim_seq_info_test.txt");

    //recombination
    rec_ends = NULL;
    rec_rates = NULL;
    for (line in info_lines[substr(info_lines, 0, 2) == "rec"])
    {
        components = strsplit(line, " ");
        rec_ends = c(rec_ends, asInteger(components[1]));
        rec_rates = c(rec_rates, asFloat(components[2]));
    }
    //multiply rec rates by scaling factor
    initializeRecombinationRate(1e-08*5);

    //exons
    for (line in info_lines[substr(info_lines, 0, 2) == "exo"])
    {
        components = strsplit(line, " ");
        exon_starts = asInteger(components[1]);
        exon_ends = asInteger(components[2]);
        initializeGenomicElement(g1, exon_starts, exon_ends);
    }

    //conserved non-coding
    //maybe incorporate this later
    //for (line in info_lines[substr(info_lines, 0, 2) == "cnc"])
    //{
    //    components = strsplit(line, " ");
    //    cnc_starts = asInteger(components[1]);
    //    cnc_ends = asInteger(components[2]);
    //    initializeGenomicElement(g2, cnc_starts, cnc_ends);
    //}
}


1:10100 fitness(m1) {
    h = mut.mutationType.dominanceCoeff;
    if (homozygous) {
        return ((1.0 + 0.5*mut.selectionCoeff)*(1.0 + 0.5*mut.selectionCoeff));
    } else {
        return (1.0 + mut.selectionCoeff * h);
    }
}


// burn-in for ancestral population
1 early(){
setSeed(c(7244273831648,1324552406041,8757415688871,7351509574698,8605153822512,3920256717907,8738989049416,6832494631254,2783718301402,6735425814429,4478206071514,8682749235626,1580118848351,6323433653409,8600857729737,419421236424,1703855603212,3904119601317,9499419725311,6073092025688,3327919925162,1010600208653,4508907970696,6478960663143,5792501967343,6156024295327,9232194792636,936253159618,7532661252840,2764153460464,1449380913309,962276477508,9716481642363,5297709229235,2775155473714,3123416929114,2076479286488,6321135294476,9480128740885,2475297872518,3877815117053,3437158721993,3878617408236,7585076514627,1862333001563,4021463740602,6949065408014,7764580767439,127073940698,5479451988345,5794542488977,6187189874553,8156030702352,6352793505131,5084056768265,1332066225480,400531403872,4942231536099,8280406312279,9434631464490,7669138701134,8320608754461,8829329095349,7505703093237,9347375974148,8171992490915,1147215149721,4542176485841,4792610303871,7034397669870,8525748582413,5825513609440,9431088025498,7084388661134,3904188631195,5977559718649,8148588752837,4215376865281,1301727622289,6309960005724,1041893013887,6373983578435,6590621590667,2537788376718,5734412151491,8397753486653,6111305949570,2221109986656,7028160451012,5226129474009,8078775226669,9467075063537,133480873392,3724822215903,6198766408732,1772129526250,7228366069731,3836445546861,3149394960469,4053022542476,3773721154749,1443149946761,8364220916860,6021311213109,2596634550133,6953901188953,3485785536644,1937089249329,2125740741596,4965662569055,4427873514972,9444749793131,8972905194693,4638972935318,2706690454141,3896680464142,923279399269,7480925453486,3910762810384,8089898998601,813447653678,3136013367388,2620095486676,7764299821183,5317572714077,5478486688957,5951506818138,6332041649374,9920069443105,6125953085993,5775663521389,9389403408462,7109059999220,6882118983064,4058736392407,6507651428340,8622699779580,5564841790526,8932569646716,4034782743967,6152700975894,3706746159719,9222077930276,7987786616494,1621480289285,7209545944075,1199925487694,7197107754847,67884451999,3546089265088,3824445394843,1592413979176,3313980074182,4746018241606,519342475446,1899583913873,626543532313,3315961609919,9557464789277,4927776606075,5978879791944,7001588387549,6012473719986,3296413475777,9993094033008,2833913567685,2173083072037,2256845847197,4640775426689,1016841028575,9892513105623,4817264320520,2308042725662,2189154166587,1762813798412,480582803988,6761000948607,1783204136515,549651925226,3334799078259,7668823215002,341763491015,2985250143428,1158274193159,1061412213102,4947310037816,5626680226908,931580478336,1083821851113,8399004140590,4983711866614,7871400939735,8273090467119,8136721325466,1138533763032,9384419097971,9218254923136,7968107079862,3155221974881,5120609294074,1399639479015,2322582889684,9174946304815,1423943736287,5055395593977,5126878199100,6631884225335,779871801454,2338581632922,229830550938,4228147488608,7809672183084,2608998194356,7843750889095,1143332948624,9074898286535,656693295621,5968411971286,8606325590168,9977338132496,6755912808528,2135044809921,1793714233808,2208510295185,2376165670282,7409540474980,8574620928711,1239519915469,7662591266476,3074097878701,3292862487236,5183657603226,365828752679,4805582994857,5923502519468,4321725958328,3202944100916,4015218499583,4627119833112,2772574261892,6624061304103,1674252852030,3575663883766,1254494687753,2190692045623,9881256100482,5830959120307,3806260894330,6456987569538,7638501125032,1492446745084,5937921707048,7294672367500,8855337524562,5816787817651,3683008452197,741189467504,1134728431255,4916317729955,3338555226480,4107155750217,8490331055266,9368998003338,7089507593639,2529473272249,7254725802406,1544317263799,5310249758838,332825214732,7989919312120,4334120151533,5027010684978,8107991324409,6347335055640,8708097659291,9239778615115,8133299043894,6544440475484,3525477743489,9232727564797,228218601727,3518013108094,9793943752121,2792667528890,733071938295,4957140104057,1965006913901,4522144694478,6361353931644,3310778496175,7122941543665,1070117347689,4194086518443,7729918065368,5441370561288,3119226817294,8380838747249,3248732382971,6339123639413,7706555317936,1662979620217,5828484125253,2492957338870,5802576633394,7872942147964,5703718138434,7274737779191,3133945510427,2171658244419,2080981829295,8498519854910,1724976564264,8312702648381,2385547724653,3418408023835,15582279904,995468213668,4557383024441,5796915405564,6084216894455,4041381883730,8114642105949,774369228482,1491757598930,3774666603660,4564453652640,98105900102,903267363151,7598959901321,6865545305433,4813477205667,6690159848818,6779719608451,5243873002263,8337975598776,2856913038229,8020180122480,590414372540,2781817652147,8951161782206,3066775943123,4920831558910,4785723931518,9963480505917,8153596317274,9232308864654,221788798960,3676451401899,9082473396690,35547751741,2984461267108,4995731520230,1854456640357,5468388784189,792398878608,8292857524782,4945856571156,7127067132382,8051439479256,7150091156984,2656622219160,3206007857348,3264762141305,91100995179,1132691508175,6563851234067,240928712764,832228208738,3336383392690,589664132606,8606098575384,7810619647024,5929358902937,1269652708045,1017831545691,2147725597640,1847522103730,3032238903417,9805040380685,5463399842807,5371039062846,8140423346955,5248445475221,7062746102515,1490374347522,4522829708091,1016658884870,5579865616332,2424644742675,6521425316552,8390046583994,2883552742396,1469771267484,4170812757394,4261580406352,9427906409456,5884093928614,396789035943,9794629974675,241254944245,851366923017,4687703488038,3820990939074,9568808712773,5021663443996,6998683145428,8755381676569,1908087411509,9432119822077,54139001699,790139901118,9112760250362,4489266667597,8388895519271,3164348513614,9637479619741,1165240258685,1059779250484,6054095003992,2189729104761,8865499794876,9089926758937,1938982150840,1686197020609,8960248152514,4374433642673,764361741672,4716356927618,9320140891492,7950767369047,7377901776558,1782054377844,3833243180953,2879971819955,6999171476282,9609296754585,6560208698540,3372158504260,3837975391714,3827173958839,7791000714092,6366104167444,4768134719875,6869198304493,9900619146371,6682134383694,2884452020326,8355044380231,7186716437926,3978258865190,6764876948821,9069013698972,1116319176951,3909783704519,1463223124864,7352676680605,2366196134341,6681517330468,3504409184149,9119427819299,736019292880,7857132302499,5598684171083,310943044962,748241442749,9024054591995,6551139379490,1828829666740,207032620463,2074959244079,2259789010497,5660349688384,5415612190296,3578642137147,496278198036,9550247461196,8026774138784,711615691132,974776480036,4555428682052,7820191175842,9146320210550,730489269241,6342825112081,2179487131401,8721657901364,1254512460653,230115564044,4086678972827,7292872147725,6651882539645,9867893319601,4151545175433,9748866469065,9852753942124,3825716972007,8698636975516,1730758137180,6349056516796,4829174330474,1663440684125,106797820944,2497140482935,1316945392747,2929735361691,9877756939429,7748614324085,5794198554731,5089472841463,627719875091,4164494606320,2404116989792,4853962136806,3013558937352,2387925603165,6604367211941,6943319069832,6533076400930,7631649735876,4963454373596,125761369208,5491659593652,9307666410158,9546069691729,981522239521,7987682975570,2286462699265,5147919869970,704646889378,760685089569,7635683195466,370123690985,9722496012101,6776177807987,1838882290891,4567285618160,901222525469,7062268685659,394004469360,3190609000659,9327076000411,4251540705903,3497722632921,2092474904165,8293006085131,5839032441786,6012557179165,514621281907,5103593418255,4515621324741,9083833426155,5170021055612,2041142656642,6877900101560,7063909840292,6902656799866,1212420087114,3713065799270,5763171788080,6202266421132,6745930199473,3926824502500,1398305287288,3531343785069,2858926114347,5438654199206,5176101096293,8310921187439,4689186770923,8939184590454,7678523962370,6330093223884,9441368211014,7936560653199,2224063527817,3822180293677,8725864327159,7525888594321,5051969715736,2715727714640,3693813828035,587322333096,2901775316614,383894407031,6628575370948,4975193442214,7873088449669,9661588089839,7826531921824,9020727494024,871066043997,1848598927840,506979180772,7911311088064,7274513015984,9752595573777,8672370856531,6196339148164,7164287855897,4787139587941,7202265645793,9055748019625,7410507616948,4064270335955,7988033949001,9386481497424,7247710046126,9175808889856,6877148039907,1321431478708,6324925099804,7949678744162,6681648722095,8620593081794,2830649068303,5382279452684,606618668135,3816953908047,9328692713344,5315707298252,712834302041,8044257523651,7325939827964,5218078516987,420287539033,4806018714762,8825879317339,4471218637738,3387525312040,177663044130,8263485491579,6589490812812,9288182400323,4530045571678,7864768633662,2902128336346,7141545515958,1040393523164,815830338513,6015829318836,7520320279326,6830226192021,1555604296792,9371461281911,7583696919637,7621094617063,9134008968206,8778702073305,2264873461333,2962928340361,5096460203037,960010388458,8788334579248,4960986106482,3829039714430,536821143451,9908305019720,8664590184488,8092433796826,6841511627812,2953857406385,4822543904533,4853065104189,5262127335004,3128087759568,4684332447348,2804950621270,371094056372,2073624747806,1013179320248,2468443355402,6512525154425,1878978799884,4642833970839,5836860285465,4272389637408,3710294199969,3595289167376,3043139330392,1055848930603,1964071268134,9501255194235,1694758610382,7358316258194,8427964890865,2995431907032,9650421802872,9642396447950,4919006625543,4975963810284,2293902504676,3981410768517,2055904063493,1443323383810,2933096476246,2337931737107,7700984348312,3686303302014,878857784544,3377616599693,5596182156959,8702208671017,8310334786753,9573542631829,5735064885286,6258654744723,3500858447760,5460046632640,5960406428492,1674559855169,9868094787705,7847848808701,7406076871842,5417046345260,504050548971,5631279148787,9672300473080,2170814061011,4130939950590,9767722169084,5126000180487,4809373988778,6415210139044,2683192861615,5212938763288,9424353712906,9435238909585,1800901011445,108359055943,1027924816571,3523933297559,3904396359590,8465568330930,9567059593460,7249451609323,9363046715362,4719550847266,4794835607572,4358531201414,7804568485387,1365498489833,9340019092528,1083440485738,2166307605395,512345831085,6620835452607,1732643545678,6190785709259,3634849402101,1215220009353,5303394923444,8278054007322,6736909146637,2202695412693,4623069141567,3990032221817,672151586152,6784754957451,9338447651552,15546253859,3566233876510,6615240801843,4915140490533,274234168118,8822084135937,4912854091048,6573534708020,1037198614407,4913957219036,2089436524176,8260039337115,1987405071804,932791162586,2868485138457,7654688802546,5909513358797,9379324912717,611166529957,8277522843912,5697300257905,9266589971413,9763612936198,5543242368938,9905947982321,9788399645745,6754618973492,3276342744003,8561021833761,7223615881819,1118382260995,5886680428803,1942369118979,822813296029,4753840201488,8239758989394,9863252096968,4692868336206,2700428841607,6163804019997,3265281708806,2968067350013,6947046894947,2594820511304,4598270986898,6794610426860,3601779441168,5886804996371,7981337810571,975731885965,2869853600500,9178941773041,7123726736259,4315962691589,9518356672741,2359109118194,2158415841852,5858473297456,8857142879044,3457996221663,9911636949062,5684585030193,3629690600503,9276018106660,7157532326977,2992412957448,9006940960616,9346764635265,558387036075,5911158564518,1408949023051,6773163667629,3018109601644,5341292626701,2379175567790,7849545914876,7572370121863,7951290614666,1019986520538,469005926499,9515113082912,3321776543906,5224692818944,4344044821077,7749252855832,3631307677708,19340569235,141226350569,944924883752,8121892033483,3337992328685,7966437716289,4048921995324,5055148060351,2152468564499,8119582056977,8340400806423,3695608179084,9559089253243,5745005217636,6768008374647,2652892197582,2952372485129,2863038201840,8808744499108,2402084038573,9393922065562,798834663978,9889343993327,9936336838756,9942122965762,5631116278341,7113232193294,6730387401476,4880940030222,6103974660182,913635243853,4791113967132,8174033793921,6536345979586,9751253144231,5542165386598,3778526597093,5205794449359,6744722886291,8086020127074,3867630920213,906850200388,9560562322838,888177986351,8896801815524,834557250870,3240779994354,997238789983,3092250836360,5189959699841,9136290030201,4649018736090,5137469481545,4149846221306,284817730655,6554999571756,3933676270554,2626901205057,6332247796688,9344075812540,4267355241094,2433986089159,1223520022188,2284302794997,7459587407904,5360576930330,9088732853291,2519684023265,3921343455539,8956804309906,490582308591,2757503278284,6237697569713,7794352719612,6684520897617,8236143037997,9846940427574,6098597794726,1226889440021,3589534386476,1939205462142,1624187117111,3451474859595,5776038931062,1228295764571,7525644012936,2926659169213,489580886393,6695390375547,4796846031470,5991586695104,522134401579,3332936791175,4159444741306,5519084375665,8447941545833,7038080975448,136414189122,3916443926384,8516928421325,2929253297794,8584637993412,5231557433754,2805224027053,6752862992129,9749270564244,6027137058034,8640002648153,1115977208232,836493294438,3884963627857,7294540389236,6819629348320,5281941394008,7045037414989,143253835448,8487151302512,4197636461197,1713030655205,6971028204964,8425555631122,1945231141264,3577729266054,4161775533825,6923798598390,7659211064822,7444934632322,9700112973990,6798994749402,1570304135834,75462457553,8921538023876,8400221233303,7531232156969,9699866915827,3733850233541,2791594845533,7224055259701,7212095548717,7803490408499,6253470532860,3963193417365,3740630150136,9823422189518,1784168392774,8715471419527,9934874139188,9153185504358,919975165318,2434401085326,1118665547237,6751066789946,2250811806402,7218944536352,1502351638292)[simnum]); //define with -d simnum=$SGE_TASK_ID
sim.addSubpop("p1", 1000); }
10000 {
p1.setSubpopulationSize(10000);
}


10010 late() {
    sim.treeSeqOutput("/project2/jnovembre/diegoortega/HaplotypeDFEStandingVariation/Scripts/Sims/SLiM/PopExpansion/PopExpansionConstantRecRate/trees_test_" + simnum + ".trees");
}
